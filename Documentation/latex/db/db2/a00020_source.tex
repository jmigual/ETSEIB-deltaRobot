\hypertarget{a00020_source}{}\section{servothread.\+h}

\begin{DoxyCode}
00001 \textcolor{preprocessor}{#ifndef SERVOTHREAD\_H}
00003 \textcolor{preprocessor}{#define SERVOTHREAD\_H}
00004 
00005 \textcolor{comment}{// Adding precompiled header}
00006 \textcolor{preprocessor}{#include "\hyperlink{a00021}{stable.h}"}
00007 
00008 \textcolor{comment}{// User libraries}
00009 \textcolor{preprocessor}{#include "\hyperlink{a00009}{dxl/ax12.h}"}
00010 
\hypertarget{a00020_source_l00013}{}\hyperlink{a00007}{00013} \textcolor{keyword}{class }\hyperlink{a00007}{ServoThread} : \textcolor{keyword}{public} QThread
00014 \{
00015     Q\_OBJECT
00016     
\hypertarget{a00020_source_l00018}{}\hyperlink{a00007_aeccce0ac6a969e2ee7cbe91687e2d085}{00018}     \textcolor{keyword}{enum} \hyperlink{a00007_aeccce0ac6a969e2ee7cbe91687e2d085}{Version} 
00019     \{
\hypertarget{a00020_source_l00020}{}\hyperlink{a00007_aeccce0ac6a969e2ee7cbe91687e2d085a319b6bf2cb120faeefbd0a5118ece7e3}{00020}         \hyperlink{a00007_aeccce0ac6a969e2ee7cbe91687e2d085a319b6bf2cb120faeefbd0a5118ece7e3}{v\_1\_0}
00021     \};
00022     
00023 \textcolor{keyword}{public}:
00024     
\hypertarget{a00020_source_l00026}{}\hyperlink{a00006}{00026}     \textcolor{keyword}{struct }\hyperlink{a00006}{Servo} 
00027     \{
\hypertarget{a00020_source_l00028}{}\hyperlink{a00006_a06b514c42113aa85fd1703fc88fca7ce}{00028}         \textcolor{keywordtype}{int} \hyperlink{a00006_a06b514c42113aa85fd1703fc88fca7ce}{ID};         
\hypertarget{a00020_source_l00029}{}\hyperlink{a00006_ae378d77acf16b306649c87fdb8df677e}{00029}         \textcolor{keywordtype}{double} \hyperlink{a00006_ae378d77acf16b306649c87fdb8df677e}{load};    
\hypertarget{a00020_source_l00030}{}\hyperlink{a00006_a9fa0aa56944b9b0bb9d66303d5bd4b59}{00030}         \textcolor{keywordtype}{double} \hyperlink{a00006_a9fa0aa56944b9b0bb9d66303d5bd4b59}{pos};     
00031         
\hypertarget{a00020_source_l00033}{}\hyperlink{a00006_a031c8e78df1e5eddf80bd2b2e2998658}{00033}         \hyperlink{a00006_a031c8e78df1e5eddf80bd2b2e2998658}{Servo}(\textcolor{keywordtype}{int} ID = -1, \textcolor{keywordtype}{double} load = -1, \textcolor{keywordtype}{double} pos = -1) 
00034             : ID(ID), load(load), pos(pos) \{\}
00035         
\hypertarget{a00020_source_l00037}{}\hyperlink{a00006_acb657f09a5d04424d134791ca501cb54}{00037}         \hyperlink{a00006_acb657f09a5d04424d134791ca501cb54}{Servo}(\textcolor{keyword}{const} \hyperlink{a00006}{Servo} &s) : ID(s.ID), load(s.load), pos(s.pos) \{\}
00038     \};
00039     
\hypertarget{a00020_source_l00041}{}\hyperlink{a00007_a8d581034e60792a9995d44065f6140a5}{00041}     \textcolor{keyword}{enum} \hyperlink{a00007_a8d581034e60792a9995d44065f6140a5}{Mode} 
00042     \{
\hypertarget{a00020_source_l00043}{}\hyperlink{a00007_a8d581034e60792a9995d44065f6140a5a6776147f492a4e0b0bb5ee4fdbc8d086}{00043}         \hyperlink{a00007_a8d581034e60792a9995d44065f6140a5a6776147f492a4e0b0bb5ee4fdbc8d086}{controlled},
\hypertarget{a00020_source_l00044}{}\hyperlink{a00007_a8d581034e60792a9995d44065f6140a5ae260aa6159d95b94851c96df939b51b3}{00044}         \hyperlink{a00007_a8d581034e60792a9995d44065f6140a5ae260aa6159d95b94851c96df939b51b3}{manual}
00045     \};
00046     
00048     \hyperlink{a00007_af021de9817b11968dd627186e9e05a71}{ServoThread}();
00049     
00051     \hyperlink{a00007_a0c7ac1f603a247eac91d9780ad50f5fa}{~ServoThread}();
00052     
\hypertarget{a00020_source_l00054}{}\hyperlink{a00007_aaa273318ffee5ba270cdaacba3f263f8}{00054}     \textcolor{keyword}{inline} \textcolor{keywordtype}{void} \hyperlink{a00007_aaa273318ffee5ba270cdaacba3f263f8}{end}()
00055     \{
00056         \hyperlink{a00007_a6327eafc0dac189ec1b202d63ef32457}{\_mutex}.lock();
00057         \hyperlink{a00007_acca9896d1a2d1ef68527e6834f81c76c}{\_end} = \textcolor{keyword}{true};
00058         \hyperlink{a00007_afcb93c09acd7fecf47d92996a297365c}{\_cond}.wakeOne();
00059         \hyperlink{a00007_a6327eafc0dac189ec1b202d63ef32457}{\_mutex}.unlock();
00060         
00061         wait();
00062     \}
00063     
00065     \textcolor{keywordtype}{void} \hyperlink{a00007_ae88d0a9c84099ca607c7cf929500fb26}{load}(QString &file);
00066     
\hypertarget{a00020_source_l00068}{}\hyperlink{a00007_ae0d4a59954aafbe8cd85f9326e4fcdd0}{00068}     \textcolor{keyword}{inline} \textcolor{keywordtype}{void} \hyperlink{a00007_ae0d4a59954aafbe8cd85f9326e4fcdd0}{pause}()
00069     \{
00070         \hyperlink{a00007_a6327eafc0dac189ec1b202d63ef32457}{\_mutex}.lock();
00071         \hyperlink{a00007_aaf2ef80e8e43518b75d20a5102970d2e}{\_pause} = \textcolor{keyword}{true};
00072         \hyperlink{a00007_a6327eafc0dac189ec1b202d63ef32457}{\_mutex}.unlock();
00073     \}
00074     
\hypertarget{a00020_source_l00076}{}\hyperlink{a00007_af2c9e71c33e15937e72703d859cd7147}{00076}     \textcolor{keyword}{inline} \textcolor{keywordtype}{int} \hyperlink{a00007_af2c9e71c33e15937e72703d859cd7147}{getServoBaud}()
00077     \{
00078         QMutexLocker mL(&\hyperlink{a00007_a6327eafc0dac189ec1b202d63ef32457}{\_mutex});
00079         \textcolor{keywordflow}{return} \hyperlink{a00007_a5b9a41b9e271275b914affb0a845a2ee}{\_sBaud};
00080     \}
00081     
\hypertarget{a00020_source_l00083}{}\hyperlink{a00007_a3fae25aeac390640192ceb38e32dae40}{00083}     \textcolor{keyword}{inline} QString \hyperlink{a00007_a3fae25aeac390640192ceb38e32dae40}{getServoPort}()
00084     \{
00085         QMutexLocker mL(&\hyperlink{a00007_a6327eafc0dac189ec1b202d63ef32457}{\_mutex});
00086         \textcolor{keywordflow}{return} \hyperlink{a00007_ac9a614aa1518efb49b0a06636bd1bdbf}{\_sPort};
00087     \}
00088     
\hypertarget{a00020_source_l00090}{}\hyperlink{a00007_afcf834d93f1ac9663d6ebaab820e5f74}{00090}     \textcolor{keyword}{inline} \textcolor{keywordtype}{void} \hyperlink{a00007_afcf834d93f1ac9663d6ebaab820e5f74}{getServoPortInfo}(QString &port, \textcolor{keywordtype}{int} &baud)
00091     \{
00092         \hyperlink{a00007_a6327eafc0dac189ec1b202d63ef32457}{\_mutex}.lock();
00093         baud = \hyperlink{a00007_a5b9a41b9e271275b914affb0a845a2ee}{\_sBaud};
00094         port = \hyperlink{a00007_ac9a614aa1518efb49b0a06636bd1bdbf}{\_sPort};
00095         \hyperlink{a00007_a6327eafc0dac189ec1b202d63ef32457}{\_mutex}.unlock();
00096     \}
00097     
00098     
\hypertarget{a00020_source_l00101}{}\hyperlink{a00007_a5fd8ef13314428f5ba7646730cc58f1c}{00101}     \textcolor{keyword}{inline} \textcolor{keywordtype}{void} \hyperlink{a00007_a5fd8ef13314428f5ba7646730cc58f1c}{getServosInfo}(QVector<Servo> &V)
00102     \{
00103         \hyperlink{a00007_a6327eafc0dac189ec1b202d63ef32457}{\_mutex}.lock();
00104         V = \hyperlink{a00007_a1ac6662fe6d198b5971ae0ffa7ddfcfd}{\_servos};
00105         \hyperlink{a00007_a6327eafc0dac189ec1b202d63ef32457}{\_mutex}.unlock();
00106     \}
00107     
\hypertarget{a00020_source_l00109}{}\hyperlink{a00007_a3d58189cdeddfb828856f192607f68d2}{00109}     \textcolor{keyword}{inline} QVector<Servo> \hyperlink{a00007_a3d58189cdeddfb828856f192607f68d2}{getServosInfo}()
00110     \{
00111         QMutexLocker mL(&\hyperlink{a00007_a6327eafc0dac189ec1b202d63ef32457}{\_mutex});
00112         \textcolor{keywordflow}{return} \hyperlink{a00007_a1ac6662fe6d198b5971ae0ffa7ddfcfd}{\_servos};
00113     \}
00114     
\hypertarget{a00020_source_l00116}{}\hyperlink{a00007_a82d074ab2c445470a6f49e2935bf6a8e}{00116}     \textcolor{keyword}{inline} QMutex* \hyperlink{a00007_a82d074ab2c445470a6f49e2935bf6a8e}{mutex}() \{ \textcolor{keywordflow}{return} &\hyperlink{a00007_a6327eafc0dac189ec1b202d63ef32457}{\_mutex}; \}
00117     
00121     \textcolor{keywordtype}{void} \hyperlink{a00007_a8497ea56991b620981ce1fbf53d9ebdb}{setData}(QVector< float > &aV, QVector<bool> &buts);
00122     
\hypertarget{a00020_source_l00125}{}\hyperlink{a00007_a009d3d1b99007b14fadb49996fac49d6}{00125}     \textcolor{keywordtype}{void} \hyperlink{a00007_a009d3d1b99007b14fadb49996fac49d6}{setServoBaud}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} baud)
00126     \{
00127         \hyperlink{a00007_a6327eafc0dac189ec1b202d63ef32457}{\_mutex}.lock();
00128         \hyperlink{a00007_a5b9a41b9e271275b914affb0a845a2ee}{\_sBaud} = baud;
00129         \hyperlink{a00007_a6327eafc0dac189ec1b202d63ef32457}{\_mutex}.unlock();
00130     \}
00131     
\hypertarget{a00020_source_l00134}{}\hyperlink{a00007_a144e31105019d833f59ca2eba012e638}{00134}     \textcolor{keywordtype}{void} \hyperlink{a00007_a144e31105019d833f59ca2eba012e638}{setServoPort}(QString &port)
00135     \{
00136         \hyperlink{a00007_a6327eafc0dac189ec1b202d63ef32457}{\_mutex}.lock();
00137         \hyperlink{a00007_ac9a614aa1518efb49b0a06636bd1bdbf}{\_sPort} = port;
00138         \hyperlink{a00007_a6327eafc0dac189ec1b202d63ef32457}{\_mutex}.unlock();
00139     \}
00140     
\hypertarget{a00020_source_l00144}{}\hyperlink{a00007_a76af3e89d1a8705426584bedb0624909}{00144}     \textcolor{keywordtype}{void} \hyperlink{a00007_a76af3e89d1a8705426584bedb0624909}{setServoPortInfo}(QString &port, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} baud)
00145     \{
00146         \hyperlink{a00007_a6327eafc0dac189ec1b202d63ef32457}{\_mutex}.lock();
00147         \hyperlink{a00007_ac9a614aa1518efb49b0a06636bd1bdbf}{\_sPort} = port;
00148         \hyperlink{a00007_a5b9a41b9e271275b914affb0a845a2ee}{\_sBaud} = baud;
00149         \hyperlink{a00007_a6327eafc0dac189ec1b202d63ef32457}{\_mutex}.unlock();
00150     \}
00151     
\hypertarget{a00020_source_l00154}{}\hyperlink{a00007_ac3471e5020f5d9babd3f2ff7b3b82aca}{00154}     \textcolor{keyword}{inline} \textcolor{keywordtype}{void} \hyperlink{a00007_ac3471e5020f5d9babd3f2ff7b3b82aca}{setSID} (QVector< int > &V) 
00155     \{
00156         \hyperlink{a00007_a6327eafc0dac189ec1b202d63ef32457}{\_mutex}.lock();
00157         \textcolor{keywordflow}{if} (V.size() != \hyperlink{a00007_a1ac6662fe6d198b5971ae0ffa7ddfcfd}{\_servos}.size()) \hyperlink{a00007_a1ac6662fe6d198b5971ae0ffa7ddfcfd}{\_servos}.resize(V.size());
00158         
00159         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < V.size(); ++i) \hyperlink{a00007_a1ac6662fe6d198b5971ae0ffa7ddfcfd}{\_servos}[i].ID = V[i];
00160         \hyperlink{a00007_a2b6ccfeacbb3cc9ac5c34549b9aa3f11}{\_dChanged} = \textcolor{keyword}{true};
00161         \hyperlink{a00007_a6327eafc0dac189ec1b202d63ef32457}{\_mutex}.unlock();
00162     \}
00163     
\hypertarget{a00020_source_l00165}{}\hyperlink{a00007_a5f32574f843d76deffec45995028389b}{00165}     \textcolor{keyword}{inline} \textcolor{keywordtype}{void} \hyperlink{a00007_a5f32574f843d76deffec45995028389b}{wakeUp}()
00166     \{
00167         \hyperlink{a00007_a6327eafc0dac189ec1b202d63ef32457}{\_mutex}.lock();
00168         \hyperlink{a00007_aaf2ef80e8e43518b75d20a5102970d2e}{\_pause} = \textcolor{keyword}{false};
00169         \hyperlink{a00007_afcb93c09acd7fecf47d92996a297365c}{\_cond}.wakeOne();
00170         \hyperlink{a00007_a6327eafc0dac189ec1b202d63ef32457}{\_mutex}.unlock();
00171     \}
00172     
00175     \textcolor{keywordtype}{void} \hyperlink{a00007_ae5753b8c12768d2115ff900f0ab8e13c}{write}(QString &file); 
00176     
00177 signals:
00178     
00180     \textcolor{keywordtype}{void} \hyperlink{a00007_a3c84cf179d1746091795c60f3a68ce06}{statusBar}(QString);
00181     
00182 \textcolor{keyword}{private}:
00183     
\hypertarget{a00020_source_l00184}{}\hyperlink{a00007_a86dc58ff23326f939cd6fb610ac90d53}{00184}     \textcolor{keyword}{const} \textcolor{keywordtype}{double} \hyperlink{a00007_a86dc58ff23326f939cd6fb610ac90d53}{cos60} = 0.5;       
\hypertarget{a00020_source_l00185}{}\hyperlink{a00007_aaa3e2dd194949b12f8a41ebd0d62fde9}{00185}     \textcolor{keyword}{const} \textcolor{keywordtype}{double} \hyperlink{a00007_aaa3e2dd194949b12f8a41ebd0d62fde9}{sin60} = sqrt(3)/2; 
\hypertarget{a00020_source_l00186}{}\hyperlink{a00007_a7dc3998d380d61406fe4485f9872edff}{00186}     \textcolor{keyword}{const} \textcolor{keywordtype}{double} \hyperlink{a00007_a7dc3998d380d61406fe4485f9872edff}{a} = 17.233;        
\hypertarget{a00020_source_l00187}{}\hyperlink{a00007_a14f03febaa39a60b9bf7ff9b9151060c}{00187}     \textcolor{keyword}{const} \textcolor{keywordtype}{double} \hyperlink{a00007_a14f03febaa39a60b9bf7ff9b9151060c}{b} = 22.648;        
\hypertarget{a00020_source_l00188}{}\hyperlink{a00007_a6281142e50115dd8c914c14cfae6f90d}{00188}     \textcolor{keyword}{const} \textcolor{keywordtype}{double} \hyperlink{a00007_a6281142e50115dd8c914c14cfae6f90d}{L1} = 5.000;        
\hypertarget{a00020_source_l00189}{}\hyperlink{a00007_a3d51c16b1f498b48a6ecbfaadaba6ed2}{00189}     \textcolor{keyword}{const} \textcolor{keywordtype}{double} \hyperlink{a00007_a3d51c16b1f498b48a6ecbfaadaba6ed2}{L2} = 6.000;        
00190     
\hypertarget{a00020_source_l00192}{}\hyperlink{a00007_aad24ef961ee39dd35766c725c13b11b7}{00192}     QVector < float > \hyperlink{a00007_aad24ef961ee39dd35766c725c13b11b7}{\_axis};
00193     
\hypertarget{a00020_source_l00195}{}\hyperlink{a00007_a6f956f7e0f2953e213ff95fb64857ab0}{00195}     QVector < bool > \hyperlink{a00007_a6f956f7e0f2953e213ff95fb64857ab0}{\_buts};
00196     
\hypertarget{a00020_source_l00198}{}\hyperlink{a00007_a9fccfd415e2e55c8abef7fcc6535af30}{00198}     \textcolor{keywordtype}{int} \hyperlink{a00007_a9fccfd415e2e55c8abef7fcc6535af30}{\_cBaud};
00199     
\hypertarget{a00020_source_l00201}{}\hyperlink{a00007_afcb93c09acd7fecf47d92996a297365c}{00201}     QWaitCondition \hyperlink{a00007_afcb93c09acd7fecf47d92996a297365c}{\_cond};
00202         
\hypertarget{a00020_source_l00204}{}\hyperlink{a00007_ab52437b31a433c427a6c050f2b1cc959}{00204}     QString \hyperlink{a00007_ab52437b31a433c427a6c050f2b1cc959}{\_cPort};
00205     
\hypertarget{a00020_source_l00207}{}\hyperlink{a00007_a2b6ccfeacbb3cc9ac5c34549b9aa3f11}{00207}     \textcolor{keywordtype}{bool} \hyperlink{a00007_a2b6ccfeacbb3cc9ac5c34549b9aa3f11}{\_dChanged};
00208     
\hypertarget{a00020_source_l00210}{}\hyperlink{a00007_acca9896d1a2d1ef68527e6834f81c76c}{00210}     \textcolor{keywordtype}{bool} \hyperlink{a00007_acca9896d1a2d1ef68527e6834f81c76c}{\_end};
00211     
\hypertarget{a00020_source_l00213}{}\hyperlink{a00007_acdecea1688594d3ab7386a6db97dd90d}{00213}     \hyperlink{a00007_a8d581034e60792a9995d44065f6140a5}{Mode} \hyperlink{a00007_acdecea1688594d3ab7386a6db97dd90d}{\_mod};
00214     
\hypertarget{a00020_source_l00216}{}\hyperlink{a00007_a6327eafc0dac189ec1b202d63ef32457}{00216}     QMutex \hyperlink{a00007_a6327eafc0dac189ec1b202d63ef32457}{\_mutex};
00217     
\hypertarget{a00020_source_l00219}{}\hyperlink{a00007_aaf2ef80e8e43518b75d20a5102970d2e}{00219}     \textcolor{keywordtype}{bool} \hyperlink{a00007_aaf2ef80e8e43518b75d20a5102970d2e}{\_pause};
00220     
\hypertarget{a00020_source_l00222}{}\hyperlink{a00007_a5b9a41b9e271275b914affb0a845a2ee}{00222}     \textcolor{keywordtype}{int} \hyperlink{a00007_a5b9a41b9e271275b914affb0a845a2ee}{\_sBaud};
00223     
\hypertarget{a00020_source_l00225}{}\hyperlink{a00007_a1ac6662fe6d198b5971ae0ffa7ddfcfd}{00225}     QVector< Servo > \hyperlink{a00007_a1ac6662fe6d198b5971ae0ffa7ddfcfd}{\_servos};
00226     
\hypertarget{a00020_source_l00228}{}\hyperlink{a00007_ac9a614aa1518efb49b0a06636bd1bdbf}{00228}     QString \hyperlink{a00007_ac9a614aa1518efb49b0a06636bd1bdbf}{\_sPort};
00229     
\hypertarget{a00020_source_l00231}{}\hyperlink{a00007_a6e803432db01b10ed975132315280fd3}{00231}     \textcolor{keywordtype}{bool} \hyperlink{a00007_a6e803432db01b10ed975132315280fd3}{\_sPortChanged};
00232     
00234     \textcolor{keywordtype}{void} \hyperlink{a00007_aeeb31b85abf7eb5c701853a6d25e51e0}{run}();
00235     
00237     \textcolor{keywordtype}{void} \hyperlink{a00007_ae17f4b27cae8b171f48fd55d2dc72dbd}{setAngles}(\textcolor{keywordtype}{double} x0, \textcolor{keywordtype}{double} y0, \textcolor{keywordtype}{double} z0, 
00238                    \textcolor{keywordtype}{double} &theta1, \textcolor{keywordtype}{double} &theta2, \textcolor{keywordtype}{double} &theta3);
00239     
00241     \textcolor{keywordtype}{double} \hyperlink{a00007_add4637d917a772c4c01a43b5b66da2be}{singleAngle}(\textcolor{keywordtype}{double} x0, \textcolor{keywordtype}{double} y0, \textcolor{keywordtype}{double} z0);
00242     
00243 \};
00244 
00245 \textcolor{preprocessor}{#endif // SERVOTHREAD\_H}
\end{DoxyCode}
