\hypertarget{servothread_8h_source}{}\section{servothread.\+h}

\begin{DoxyCode}
00001 \textcolor{preprocessor}{#ifndef SERVOTHREAD\_H}
00003 \textcolor{preprocessor}{#define SERVOTHREAD\_H}
00004 
00005 \textcolor{comment}{// Qt Libraries}
00006 \textcolor{preprocessor}{#include <QDebug>}
00007 \textcolor{preprocessor}{#include <QDir>}
00008 \textcolor{preprocessor}{#include <QMutex>}
00009 \textcolor{preprocessor}{#include <QThread>}
00010 \textcolor{preprocessor}{#include <QVector>}
00011 \textcolor{preprocessor}{#include <QWaitCondition>}
00012 
00013 \textcolor{comment}{// Other libraries}
00014 \textcolor{preprocessor}{#include <xjoystick.h>}
00015 
00016 \textcolor{comment}{// User libraries}
00017 \textcolor{preprocessor}{#include "\hyperlink{ax12_8h}{dxl/ax12.h}"}
00018 
\hypertarget{servothread_8h_source_l00021}{}\hyperlink{class_servo_thread}{00021} \textcolor{keyword}{class }\hyperlink{class_servo_thread}{ServoThread} : \textcolor{keyword}{public} QThread
00022 \{
00023     Q\_OBJECT
00024     
\hypertarget{servothread_8h_source_l00026}{}\hyperlink{class_servo_thread_aeccce0ac6a969e2ee7cbe91687e2d085}{00026}     \textcolor{keyword}{enum} \hyperlink{class_servo_thread_aeccce0ac6a969e2ee7cbe91687e2d085}{Version} 
00027     \{
\hypertarget{servothread_8h_source_l00028}{}\hyperlink{class_servo_thread_aeccce0ac6a969e2ee7cbe91687e2d085a319b6bf2cb120faeefbd0a5118ece7e3}{00028}         \hyperlink{class_servo_thread_aeccce0ac6a969e2ee7cbe91687e2d085a319b6bf2cb120faeefbd0a5118ece7e3}{v\_1\_0}
00029     \};
00030     
00031 \textcolor{keyword}{public}:
00032     
\hypertarget{servothread_8h_source_l00034}{}\hyperlink{struct_servo_thread_1_1_servo}{00034}     \textcolor{keyword}{struct }\hyperlink{struct_servo_thread_1_1_servo}{Servo} 
00035     \{
\hypertarget{servothread_8h_source_l00036}{}\hyperlink{struct_servo_thread_1_1_servo_a06b514c42113aa85fd1703fc88fca7ce}{00036}         \textcolor{keywordtype}{int} \hyperlink{struct_servo_thread_1_1_servo_a06b514c42113aa85fd1703fc88fca7ce}{ID};         
\hypertarget{servothread_8h_source_l00037}{}\hyperlink{struct_servo_thread_1_1_servo_ae378d77acf16b306649c87fdb8df677e}{00037}         \textcolor{keywordtype}{double} \hyperlink{struct_servo_thread_1_1_servo_ae378d77acf16b306649c87fdb8df677e}{load};    
\hypertarget{servothread_8h_source_l00038}{}\hyperlink{struct_servo_thread_1_1_servo_a9fa0aa56944b9b0bb9d66303d5bd4b59}{00038}         \textcolor{keywordtype}{double} \hyperlink{struct_servo_thread_1_1_servo_a9fa0aa56944b9b0bb9d66303d5bd4b59}{pos};     
00039         
\hypertarget{servothread_8h_source_l00041}{}\hyperlink{struct_servo_thread_1_1_servo_a031c8e78df1e5eddf80bd2b2e2998658}{00041}         \hyperlink{struct_servo_thread_1_1_servo_a031c8e78df1e5eddf80bd2b2e2998658}{Servo}(\textcolor{keywordtype}{int} ID = -1, \textcolor{keywordtype}{double} load = -1, \textcolor{keywordtype}{double} pos = -1) 
00042             : ID(ID), load(load), pos(pos) \{\}
00043         
\hypertarget{servothread_8h_source_l00045}{}\hyperlink{struct_servo_thread_1_1_servo_acb657f09a5d04424d134791ca501cb54}{00045}         \hyperlink{struct_servo_thread_1_1_servo_acb657f09a5d04424d134791ca501cb54}{Servo}(\textcolor{keyword}{const} \hyperlink{struct_servo_thread_1_1_servo}{Servo} &s) : ID(s.ID), load(s.load), pos(s.pos) \{\}
00046     \};
00047     
\hypertarget{servothread_8h_source_l00049}{}\hyperlink{class_servo_thread_a8d581034e60792a9995d44065f6140a5}{00049}     \textcolor{keyword}{enum} \hyperlink{class_servo_thread_a8d581034e60792a9995d44065f6140a5}{Mode} 
00050     \{
\hypertarget{servothread_8h_source_l00051}{}\hyperlink{class_servo_thread_a8d581034e60792a9995d44065f6140a5a6776147f492a4e0b0bb5ee4fdbc8d086}{00051}         \hyperlink{class_servo_thread_a8d581034e60792a9995d44065f6140a5a6776147f492a4e0b0bb5ee4fdbc8d086}{controlled},
\hypertarget{servothread_8h_source_l00052}{}\hyperlink{class_servo_thread_a8d581034e60792a9995d44065f6140a5ae260aa6159d95b94851c96df939b51b3}{00052}         \hyperlink{class_servo_thread_a8d581034e60792a9995d44065f6140a5ae260aa6159d95b94851c96df939b51b3}{manual}
00053     \};
00054     
00056     \hyperlink{class_servo_thread_af021de9817b11968dd627186e9e05a71}{ServoThread}();
00057     
00059     \hyperlink{class_servo_thread_a0c7ac1f603a247eac91d9780ad50f5fa}{~ServoThread}();
00060     
\hypertarget{servothread_8h_source_l00062}{}\hyperlink{class_servo_thread_a01c61d9505a2aeaa1a4fa4c05474738c}{00062}     \textcolor{keyword}{inline} \textcolor{keywordtype}{void} \hyperlink{class_servo_thread_a01c61d9505a2aeaa1a4fa4c05474738c}{cont}()
00063     \{
00064         \hyperlink{class_servo_thread_a6327eafc0dac189ec1b202d63ef32457}{\_mutex}.lock();
00065         \hyperlink{class_servo_thread_aaf2ef80e8e43518b75d20a5102970d2e}{\_pause} = \textcolor{keyword}{false};
00066         \hyperlink{class_servo_thread_afcb93c09acd7fecf47d92996a297365c}{\_cond}.wakeOne();
00067         \hyperlink{class_servo_thread_a6327eafc0dac189ec1b202d63ef32457}{\_mutex}.unlock();
00068     \}
00069     
\hypertarget{servothread_8h_source_l00071}{}\hyperlink{class_servo_thread_aaa273318ffee5ba270cdaacba3f263f8}{00071}     \textcolor{keyword}{inline} \textcolor{keywordtype}{void} \hyperlink{class_servo_thread_aaa273318ffee5ba270cdaacba3f263f8}{end}()
00072     \{
00073         \hyperlink{class_servo_thread_a6327eafc0dac189ec1b202d63ef32457}{\_mutex}.lock();
00074         \hyperlink{class_servo_thread_acca9896d1a2d1ef68527e6834f81c76c}{\_end} = \textcolor{keyword}{true};
00075         \hyperlink{class_servo_thread_afcb93c09acd7fecf47d92996a297365c}{\_cond}.wakeOne();
00076         \hyperlink{class_servo_thread_a6327eafc0dac189ec1b202d63ef32457}{\_mutex}.unlock();
00077         
00078         wait();
00079     \}
00080     
00082     \textcolor{keywordtype}{void} \hyperlink{class_servo_thread_ae88d0a9c84099ca607c7cf929500fb26}{load}(QString &file);
00083     
\hypertarget{servothread_8h_source_l00085}{}\hyperlink{class_servo_thread_ae0d4a59954aafbe8cd85f9326e4fcdd0}{00085}     \textcolor{keyword}{inline} \textcolor{keywordtype}{void} \hyperlink{class_servo_thread_ae0d4a59954aafbe8cd85f9326e4fcdd0}{pause}()
00086     \{
00087         \hyperlink{class_servo_thread_a6327eafc0dac189ec1b202d63ef32457}{\_mutex}.lock();
00088         \hyperlink{class_servo_thread_aaf2ef80e8e43518b75d20a5102970d2e}{\_pause} = \textcolor{keyword}{true};
00089         \hyperlink{class_servo_thread_a6327eafc0dac189ec1b202d63ef32457}{\_mutex}.unlock();
00090     \}
00091     
\hypertarget{servothread_8h_source_l00093}{}\hyperlink{class_servo_thread_af2c9e71c33e15937e72703d859cd7147}{00093}     \textcolor{keyword}{inline} \textcolor{keywordtype}{int} \hyperlink{class_servo_thread_af2c9e71c33e15937e72703d859cd7147}{getServoBaud}()
00094     \{
00095         QMutexLocker mL(&\hyperlink{class_servo_thread_a6327eafc0dac189ec1b202d63ef32457}{\_mutex});
00096         \textcolor{keywordflow}{return} \hyperlink{class_servo_thread_a5b9a41b9e271275b914affb0a845a2ee}{\_sBaud};
00097     \}
00098     
\hypertarget{servothread_8h_source_l00100}{}\hyperlink{class_servo_thread_a3fae25aeac390640192ceb38e32dae40}{00100}     \textcolor{keyword}{inline} QString \hyperlink{class_servo_thread_a3fae25aeac390640192ceb38e32dae40}{getServoPort}()
00101     \{
00102         QMutexLocker mL(&\hyperlink{class_servo_thread_a6327eafc0dac189ec1b202d63ef32457}{\_mutex});
00103         \textcolor{keywordflow}{return} \hyperlink{class_servo_thread_ac9a614aa1518efb49b0a06636bd1bdbf}{\_sPort};
00104     \}
00105     
\hypertarget{servothread_8h_source_l00107}{}\hyperlink{class_servo_thread_afcf834d93f1ac9663d6ebaab820e5f74}{00107}     \textcolor{keyword}{inline} \textcolor{keywordtype}{void} \hyperlink{class_servo_thread_afcf834d93f1ac9663d6ebaab820e5f74}{getServoPortInfo}(QString &port, \textcolor{keywordtype}{int} &baud)
00108     \{
00109         \hyperlink{class_servo_thread_a6327eafc0dac189ec1b202d63ef32457}{\_mutex}.lock();
00110         baud = \hyperlink{class_servo_thread_a5b9a41b9e271275b914affb0a845a2ee}{\_sBaud};
00111         port = \hyperlink{class_servo_thread_ac9a614aa1518efb49b0a06636bd1bdbf}{\_sPort};
00112         \hyperlink{class_servo_thread_a6327eafc0dac189ec1b202d63ef32457}{\_mutex}.unlock();
00113     \}
00114     
00115     
\hypertarget{servothread_8h_source_l00118}{}\hyperlink{class_servo_thread_a5fd8ef13314428f5ba7646730cc58f1c}{00118}     \textcolor{keyword}{inline} \textcolor{keywordtype}{void} \hyperlink{class_servo_thread_a5fd8ef13314428f5ba7646730cc58f1c}{getServosInfo}(QVector<Servo> &V)
00119     \{
00120         \hyperlink{class_servo_thread_a6327eafc0dac189ec1b202d63ef32457}{\_mutex}.lock();
00121         V = \hyperlink{class_servo_thread_a1ac6662fe6d198b5971ae0ffa7ddfcfd}{\_servos};
00122         \hyperlink{class_servo_thread_a6327eafc0dac189ec1b202d63ef32457}{\_mutex}.unlock();
00123     \}
00124     
\hypertarget{servothread_8h_source_l00126}{}\hyperlink{class_servo_thread_a3d58189cdeddfb828856f192607f68d2}{00126}     \textcolor{keyword}{inline} QVector<Servo> \hyperlink{class_servo_thread_a3d58189cdeddfb828856f192607f68d2}{getServosInfo}()
00127     \{
00128         QMutexLocker mL(&\hyperlink{class_servo_thread_a6327eafc0dac189ec1b202d63ef32457}{\_mutex});
00129         \textcolor{keywordflow}{return} \hyperlink{class_servo_thread_a1ac6662fe6d198b5971ae0ffa7ddfcfd}{\_servos};
00130     \}
00131     
00135     \textcolor{keywordtype}{void} \hyperlink{class_servo_thread_a8497ea56991b620981ce1fbf53d9ebdb}{setData}(QVector< float > &aV, QVector<bool> &buts);
00136     
\hypertarget{servothread_8h_source_l00139}{}\hyperlink{class_servo_thread_a009d3d1b99007b14fadb49996fac49d6}{00139}     \textcolor{keywordtype}{void} \hyperlink{class_servo_thread_a009d3d1b99007b14fadb49996fac49d6}{setServoBaud}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} baud)
00140     \{
00141         \hyperlink{class_servo_thread_a6327eafc0dac189ec1b202d63ef32457}{\_mutex}.lock();
00142         \hyperlink{class_servo_thread_a5b9a41b9e271275b914affb0a845a2ee}{\_sBaud} = baud;
00143         \hyperlink{class_servo_thread_a6327eafc0dac189ec1b202d63ef32457}{\_mutex}.unlock();
00144     \}
00145     
\hypertarget{servothread_8h_source_l00148}{}\hyperlink{class_servo_thread_a144e31105019d833f59ca2eba012e638}{00148}     \textcolor{keywordtype}{void} \hyperlink{class_servo_thread_a144e31105019d833f59ca2eba012e638}{setServoPort}(QString &port)
00149     \{
00150         \hyperlink{class_servo_thread_a6327eafc0dac189ec1b202d63ef32457}{\_mutex}.lock();
00151         \hyperlink{class_servo_thread_ac9a614aa1518efb49b0a06636bd1bdbf}{\_sPort} = port;
00152         \hyperlink{class_servo_thread_a6327eafc0dac189ec1b202d63ef32457}{\_mutex}.unlock();
00153     \}
00154     
\hypertarget{servothread_8h_source_l00158}{}\hyperlink{class_servo_thread_a76af3e89d1a8705426584bedb0624909}{00158}     \textcolor{keywordtype}{void} \hyperlink{class_servo_thread_a76af3e89d1a8705426584bedb0624909}{setServoPortInfo}(QString &port, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} baud)
00159     \{
00160         \hyperlink{class_servo_thread_a6327eafc0dac189ec1b202d63ef32457}{\_mutex}.lock();
00161         \hyperlink{class_servo_thread_ac9a614aa1518efb49b0a06636bd1bdbf}{\_sPort} = port;
00162         \hyperlink{class_servo_thread_a5b9a41b9e271275b914affb0a845a2ee}{\_sBaud} = baud;
00163         \hyperlink{class_servo_thread_a6327eafc0dac189ec1b202d63ef32457}{\_mutex}.unlock();
00164     \}
00165     
\hypertarget{servothread_8h_source_l00168}{}\hyperlink{class_servo_thread_ac3471e5020f5d9babd3f2ff7b3b82aca}{00168}     \textcolor{keyword}{inline} \textcolor{keywordtype}{void} \hyperlink{class_servo_thread_ac3471e5020f5d9babd3f2ff7b3b82aca}{setSID} (QVector< int > &V) 
00169     \{
00170         \hyperlink{class_servo_thread_a6327eafc0dac189ec1b202d63ef32457}{\_mutex}.lock();
00171         \textcolor{keywordflow}{if} (V.size() != \hyperlink{class_servo_thread_a1ac6662fe6d198b5971ae0ffa7ddfcfd}{\_servos}.size()) \hyperlink{class_servo_thread_a1ac6662fe6d198b5971ae0ffa7ddfcfd}{\_servos}.resize(V.size());
00172         
00173         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < V.size(); ++i) \hyperlink{class_servo_thread_a1ac6662fe6d198b5971ae0ffa7ddfcfd}{\_servos}[i].ID = V[i];
00174         \hyperlink{class_servo_thread_a2b6ccfeacbb3cc9ac5c34549b9aa3f11}{\_dChanged} = \textcolor{keyword}{true};
00175         \hyperlink{class_servo_thread_a6327eafc0dac189ec1b202d63ef32457}{\_mutex}.unlock();
00176     \}
00177     
00180     \textcolor{keywordtype}{void} \hyperlink{class_servo_thread_ae5753b8c12768d2115ff900f0ab8e13c}{write}(QString &file); 
00181     
00182 \textcolor{keyword}{private}:
00183     
\hypertarget{servothread_8h_source_l00184}{}\hyperlink{class_servo_thread_a5254b08335f14de98d18aed01abc6f58}{00184}     \textcolor{keywordtype}{double} \hyperlink{class_servo_thread_a5254b08335f14de98d18aed01abc6f58}{cos60} = 0.5;         
\hypertarget{servothread_8h_source_l00185}{}\hyperlink{class_servo_thread_addbe4545236e5ded8c4956f2e2d52a84}{00185}     \textcolor{keywordtype}{double} \hyperlink{class_servo_thread_addbe4545236e5ded8c4956f2e2d52a84}{sin60} = sqrt(3)/2;   
\hypertarget{servothread_8h_source_l00186}{}\hyperlink{class_servo_thread_a7dc3998d380d61406fe4485f9872edff}{00186}     \textcolor{keyword}{const} \textcolor{keywordtype}{double} \hyperlink{class_servo_thread_a7dc3998d380d61406fe4485f9872edff}{a};             
\hypertarget{servothread_8h_source_l00187}{}\hyperlink{class_servo_thread_a14f03febaa39a60b9bf7ff9b9151060c}{00187}     \textcolor{keyword}{const} \textcolor{keywordtype}{double} \hyperlink{class_servo_thread_a14f03febaa39a60b9bf7ff9b9151060c}{b};             
\hypertarget{servothread_8h_source_l00188}{}\hyperlink{class_servo_thread_a6281142e50115dd8c914c14cfae6f90d}{00188}     \textcolor{keyword}{const} \textcolor{keywordtype}{double} \hyperlink{class_servo_thread_a6281142e50115dd8c914c14cfae6f90d}{L1};            
\hypertarget{servothread_8h_source_l00189}{}\hyperlink{class_servo_thread_a3d51c16b1f498b48a6ecbfaadaba6ed2}{00189}     \textcolor{keyword}{const} \textcolor{keywordtype}{double} \hyperlink{class_servo_thread_a3d51c16b1f498b48a6ecbfaadaba6ed2}{L2};            
00190     
\hypertarget{servothread_8h_source_l00192}{}\hyperlink{class_servo_thread_aad24ef961ee39dd35766c725c13b11b7}{00192}     QVector < float > \hyperlink{class_servo_thread_aad24ef961ee39dd35766c725c13b11b7}{\_axis};
00193     
\hypertarget{servothread_8h_source_l00195}{}\hyperlink{class_servo_thread_a6f956f7e0f2953e213ff95fb64857ab0}{00195}     QVector < bool > \hyperlink{class_servo_thread_a6f956f7e0f2953e213ff95fb64857ab0}{\_buts};
00196     
\hypertarget{servothread_8h_source_l00198}{}\hyperlink{class_servo_thread_a9fccfd415e2e55c8abef7fcc6535af30}{00198}     \textcolor{keywordtype}{int} \hyperlink{class_servo_thread_a9fccfd415e2e55c8abef7fcc6535af30}{\_cBaud};
00199     
\hypertarget{servothread_8h_source_l00201}{}\hyperlink{class_servo_thread_afcb93c09acd7fecf47d92996a297365c}{00201}     QWaitCondition \hyperlink{class_servo_thread_afcb93c09acd7fecf47d92996a297365c}{\_cond};
00202         
\hypertarget{servothread_8h_source_l00204}{}\hyperlink{class_servo_thread_ab52437b31a433c427a6c050f2b1cc959}{00204}     QString \hyperlink{class_servo_thread_ab52437b31a433c427a6c050f2b1cc959}{\_cPort};
00205     
\hypertarget{servothread_8h_source_l00207}{}\hyperlink{class_servo_thread_a2b6ccfeacbb3cc9ac5c34549b9aa3f11}{00207}     \textcolor{keywordtype}{bool} \hyperlink{class_servo_thread_a2b6ccfeacbb3cc9ac5c34549b9aa3f11}{\_dChanged};
00208     
\hypertarget{servothread_8h_source_l00210}{}\hyperlink{class_servo_thread_acca9896d1a2d1ef68527e6834f81c76c}{00210}     \textcolor{keywordtype}{bool} \hyperlink{class_servo_thread_acca9896d1a2d1ef68527e6834f81c76c}{\_end};
00211     
\hypertarget{servothread_8h_source_l00213}{}\hyperlink{class_servo_thread_acdecea1688594d3ab7386a6db97dd90d}{00213}     \hyperlink{class_servo_thread_a8d581034e60792a9995d44065f6140a5}{Mode} \hyperlink{class_servo_thread_acdecea1688594d3ab7386a6db97dd90d}{\_mod};
00214     
\hypertarget{servothread_8h_source_l00216}{}\hyperlink{class_servo_thread_a6327eafc0dac189ec1b202d63ef32457}{00216}     QMutex \hyperlink{class_servo_thread_a6327eafc0dac189ec1b202d63ef32457}{\_mutex};
00217     
\hypertarget{servothread_8h_source_l00219}{}\hyperlink{class_servo_thread_aaf2ef80e8e43518b75d20a5102970d2e}{00219}     \textcolor{keywordtype}{bool} \hyperlink{class_servo_thread_aaf2ef80e8e43518b75d20a5102970d2e}{\_pause};
00220     
\hypertarget{servothread_8h_source_l00222}{}\hyperlink{class_servo_thread_a5b9a41b9e271275b914affb0a845a2ee}{00222}     \textcolor{keywordtype}{int} \hyperlink{class_servo_thread_a5b9a41b9e271275b914affb0a845a2ee}{\_sBaud};
00223     
\hypertarget{servothread_8h_source_l00225}{}\hyperlink{class_servo_thread_a1ac6662fe6d198b5971ae0ffa7ddfcfd}{00225}     QVector< Servo > \hyperlink{class_servo_thread_a1ac6662fe6d198b5971ae0ffa7ddfcfd}{\_servos};
00226     
\hypertarget{servothread_8h_source_l00228}{}\hyperlink{class_servo_thread_ac9a614aa1518efb49b0a06636bd1bdbf}{00228}     QString \hyperlink{class_servo_thread_ac9a614aa1518efb49b0a06636bd1bdbf}{\_sPort};
00229     
\hypertarget{servothread_8h_source_l00231}{}\hyperlink{class_servo_thread_a6e803432db01b10ed975132315280fd3}{00231}     \textcolor{keywordtype}{bool} \hyperlink{class_servo_thread_a6e803432db01b10ed975132315280fd3}{\_sPortChanged};
00232     
00234     \textcolor{keywordtype}{void} \hyperlink{class_servo_thread_aeeb31b85abf7eb5c701853a6d25e51e0}{run}();
00235     
00237     \textcolor{keywordtype}{void} \hyperlink{class_servo_thread_ae17f4b27cae8b171f48fd55d2dc72dbd}{setAngles}(\textcolor{keywordtype}{double} x0, \textcolor{keywordtype}{double} y0, \textcolor{keywordtype}{double} z0, 
00238                    \textcolor{keywordtype}{double} &theta1, \textcolor{keywordtype}{double} &theta2, \textcolor{keywordtype}{double} &theta3);
00239     
00241     \textcolor{keywordtype}{double} \hyperlink{class_servo_thread_add4637d917a772c4c01a43b5b66da2be}{singleAngle}(\textcolor{keywordtype}{double} x0, \textcolor{keywordtype}{double} y0, \textcolor{keywordtype}{double} z0);
00242     
00243 \};
00244 
00245 \textcolor{preprocessor}{#endif // SERVOTHREAD\_H}
\end{DoxyCode}
